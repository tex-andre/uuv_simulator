<launch>
  <arg name="debug" default="0"/>
  <arg name="mode" default="default"/>
  <arg name="use_ned_frame" default="false"/>
  <arg name="model_name" default="rexrov"/>
  <arg name="velocity_control" default="true"/>
  
  <arg name="roll" default="0.0"/>
  <arg name="pitch" default="0.0"/>
  <arg name="yaw" default="0.0"/>

  <!-- position robot -->
  <arg name="namespace" default="rexrov"/>
  <arg name="x" default="0"/>
  <arg name="y" default="0"/>
  <arg name="z" default="-2"/>

  <!-- add robot -->
  <include file="$(find uuv_descriptions)/launch/upload_rexrov_$(arg mode).launch">
    <arg name="debug" value="$(arg debug)"/>
    <arg name="x" value="$(arg x)"/>
    <arg name="y" value="$(arg y)"/>
    <arg name="z" value="$(arg z)"/>
    <arg name="roll" value="$(arg roll)"/>
    <arg name="pitch" value="$(arg pitch)"/>
    <arg name="yaw" value="$(arg yaw)"/>
    <arg name="use_ned_frame" value="$(arg use_ned_frame)"/>
    <arg name="namespace" value="$(arg namespace)"/>
  </include>

  <!-- #### robot control #### -->
  <group if="$(arg velocity_control)">
    <include file="$(find uuv_thruster_manager)/launch/thruster_manager.launch">
      <arg name="uuv_name" value="$(arg namespace)" />
      <arg name="model_name" value="$(arg model_name)" />
    </include>
  
    <group ns="$(arg namespace)">
      <rosparam file="$(find uuv_control_cascaded_pid)/config/$(arg model_name)/inertial.yaml" command="load"/>
      <rosparam file="$(find uuv_control_cascaded_pid)/config/$(arg model_name)/vel_pid_control.yaml" command="load"/>

      <node pkg="uuv_control_cascaded_pid" type="AccelerationControl.py" name="acceleration_control"
            output="screen">
        <param name="tf_prefix" type="string" value="$(arg namespace)/" />
      </node>

      <node pkg="uuv_control_cascaded_pid" type="VelocityControl.py" name="velocity_control"
          output="screen">
        <remap from="odom" to="/$(arg namespace)/pose_gt"/>
        <remap from="cmd_accel" to="/$(arg namespace)/cmd_accel"/>
      </node>
    </group>
  </group>

  <group unless="$(arg velocity_control)">
    <include file="$(find uuv_trajectory_control)/launch/rov_pid_controller.launch">
      <arg name="uuv_name" value="$(arg namespace)"/>
      <arg name="model_name" value="$(arg model_name)"/>
    </include>
  </group>
  <!-- #### robot control #### -->

</launch>